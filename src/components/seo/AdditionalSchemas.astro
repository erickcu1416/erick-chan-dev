---
import { getCurrentLocale } from '@i18n/index';

interface Props {
  schemas: Array<'breadcrumb' | 'localBusiness' | 'service'>;
  breadcrumbItems?: Array<{ name: string; url: string }>;
  serviceName?: string;
  serviceDescription?: string;
}

const { schemas, breadcrumbItems = [], serviceName, serviceDescription } = Astro.props;
const locale = getCurrentLocale(Astro.url.pathname);
const siteUrl = Astro.site?.toString() || 'https://erickchan.dev';

const allSchemas = [];

// Breadcrumb Schema
if (schemas.includes('breadcrumb') && breadcrumbItems.length > 0) {
  const breadcrumbList = {
    '@context': 'https://schema.org',
    '@type': 'BreadcrumbList',
    itemListElement: breadcrumbItems.map((item, index) => ({
      '@type': 'ListItem',
      position: index + 1,
      name: item.name,
      item: `${siteUrl}${item.url}`,
    })),
  };
  allSchemas.push(breadcrumbList);
}

// Local Business Schema
if (schemas.includes('localBusiness')) {
  const localBusiness = {
    '@context': 'https://schema.org',
    '@type': 'LocalBusiness',
    '@id': `${siteUrl}/#localbusiness`,
    name: 'Erick Chan',
    image: `${siteUrl}/android-chrome-512x512.png`,
    url: siteUrl,
    telephone: '+52-998-220-3423',
    email: 'hello@erickchan.dev',
    address: {
      '@type': 'PostalAddress',
      streetAddress: '',
      addressLocality: 'Cancún',
      addressRegion: 'Quintana Roo',
      postalCode: '77500',
      addressCountry: 'MX',
    },
    geo: {
      '@type': 'GeoCoordinates',
      latitude: '21.1619',
      longitude: '-86.8515',
    },
    openingHoursSpecification: [
      {
        '@type': 'OpeningHoursSpecification',
        dayOfWeek: ['Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday'],
        opens: '09:00',
        closes: '19:00',
      },
      {
        '@type': 'OpeningHoursSpecification',
        dayOfWeek: 'Saturday',
        opens: '10:00',
        closes: '14:00',
      },
    ],
    sameAs: [
      'https://github.com/erickcu1416',
      'https://www.linkedin.com/in/erick-chan-90584617b',
      'https://www.instagram.com/thekingroyalan/',
    ],
    priceRange: '$$-$$$',
    serviceArea: {
      '@type': 'GeoCircle',
      geoMidpoint: {
        '@type': 'GeoCoordinates',
        latitude: '21.1619',
        longitude: '-86.8515',
      },
      geoRadius: '50000',
    },
  };
  allSchemas.push(localBusiness);
}

// Service Schema
if (schemas.includes('service') && serviceName && serviceDescription) {
  const service = {
    '@context': 'https://schema.org',
    '@type': 'Service',
    name: serviceName,
    description: serviceDescription,
    provider: {
      '@type': 'Person',
      name: 'Erick Chan',
      url: siteUrl,
    },
    areaServed: {
      '@type': 'Country',
      name: 'Mexico',
    },
    hasOfferCatalog: {
      '@type': 'OfferCatalog',
      name: locale === 'es' ? 'Servicios de Desarrollo' : 'Development Services',
      itemListElement: [
        {
          '@type': 'OfferCatalog',
          name: locale === 'es' ? 'Desarrollo Web' : 'Web Development',
          itemListElement: [
            {
              '@type': 'Offer',
              itemOffered: {
                '@type': 'Service',
                name: locale === 'es' ? 'Sitios Web Personalizados' : 'Custom Websites',
              },
            },
          ],
        },
        {
          '@type': 'OfferCatalog',
          name: locale === 'es' ? 'Desarrollo Móvil' : 'Mobile Development',
          itemListElement: [
            {
              '@type': 'Offer',
              itemOffered: {
                '@type': 'Service',
                name: locale === 'es' ? 'Aplicaciones iOS y Android' : 'iOS and Android Apps',
              },
            },
          ],
        },
      ],
    },
  };
  allSchemas.push(service);
}
---

{allSchemas.map((schema) => (
  <script type="application/ld+json" set:html={JSON.stringify(schema)} />
))}
